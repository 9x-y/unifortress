# План разработки UniFortress (Начальный этап)

## Фаза 1: Настройка проекта и базовая структура

1.  **Создание структуры каталогов:**
    *   Создать директории: `src/`, `tests/`, `scripts/`, `docs/`.
2.  **Инициализация Rust проекта:**
    *   Выполнить `cargo init` в корневой директории.
3.  **Настройка `Cargo.toml`:**
    *   Добавить базовые зависимости:
        *   Криптография (например, `aes`, `xts-mode`, `hmac`, `sha2`, `pbkdf2`/`argon2`).
        *   Обработка ошибок (например, `anyhow` или `thiserror`).
        *   Сериализация/десериализация (например, `serde`, `bincode`).
        *   Логирование (например, `log`, `env_logger`).
4.  **Создание основных файлов:**
    *   Создать пустые файлы согласно структуре в ТЗ (`src/main.rs`, `src/encryption.rs`, `src/decryption.rs`, `src/platform/mod.rs`, `src/platform/common.rs`, `src/utils.rs`, `tests/integration_test.rs` и т.д.).
5.  **Базовые утилиты и структуры (`src/utils.rs`, `src/lib.rs` или `src/common.rs`):**
    *   Определить основные структуры данных (формат заголовка тома, метаданные).
    *   Реализовать базовые функции для логирования и обработки ошибок.

## Фаза 2: Ядро криптографии

1.  **Производная ключа (KDF):**
    *   Реализовать функцию генерации ключа шифрования из пароля пользователя с использованием PBKDF2 или Argon2.
2.  **Работа с заголовком:**
    *   Реализовать сериализацию и десериализацию структуры заголовка.
    *   Добавить проверку целостности заголовка с помощью HMAC.
3.  **Шифрование/Дешифрование (AES-XTS):**
    *   Реализовать обертки над библиотечными функциями для шифрования и дешифрования блоков данных с использованием AES-256 XTS.
4.  **Модульные тесты:**
    *   Написать тесты для KDF, работы с заголовком и функций шифрования/дешифрования.

## Фаза 3: Начальная интеграция с платформой (например, Windows) и базовый CLI

1.  **Базовый интерфейс (CLI):**
    *   Создать простое CLI-приложение (используя, например, `clap`) для основных команд: `encrypt`, `unlock`.
2.  **Взаимодействие с ОС:**
    *   Реализовать функции для обнаружения USB-накопителей (в `src/platform/windows.rs`).
    *   Реализовать базовые операции ввода-вывода для чтения/записи секторов на устройстве.
3.  **Реализация сценария "Encrypt":**
    *   Чтение пароля.
    *   Форматирование (если необходимо).
    *   Генерация ключа, запись заголовка на флешку.
    *   (Опционально) Начало фонового шифрования.
4.  **Реализация сценария "Unlock":**
    *   Чтение заголовка с флешки.
    *   Проверка пароля (через KDF и сравнение ключей или проверку HMAC).
    *   Подготовка к предоставлению доступа к данным (например, монтирование виртуального диска или запуск прокси-сервиса).

## Следующие шаги (последующие фазы):

*   Реализация адаптеров для других платформ (macOS, Linux).
*   Разработка мобильных приложений (Android, iOS) и взаимодействие с ядром Rust.
*   Разработка GUI.
*   Расширенное тестирование (интеграционное, производительности, безопасности).
*   Документация. 